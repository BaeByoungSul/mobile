import{$b as v,ac as x,c as l,d as u,dc as j,e as a,ec as $,g as f,gc as y,hc as C,ic as D,j as m,k as w,l as b,m as p,o as I,q as k,r as T,u as d,x as U}from"./chunk-KOMPBYRF.js";import{f as h}from"./chunk-D7YYRZS5.js";var s=class extends Error{};s.prototype.name="InvalidTokenError";function P(n){return decodeURIComponent(atob(n).replace(/(.)/g,(t,o)=>{let e=o.charCodeAt(0).toString(16).toUpperCase();return e.length<2&&(e="0"+e),"%"+e}))}function W(n){let t=n.replace(/-/g,"+").replace(/_/g,"/");switch(t.length%4){case 0:break;case 2:t+="==";break;case 3:t+="=";break;default:throw new Error("base64 string is not of the correct length")}try{return P(t)}catch{return atob(t)}}function g(n,t){if(typeof n!="string")throw new s("Invalid token specified: must be a string");t||(t={});let o=t.header===!0?0:1,e=n.split(".")[o];if(typeof e!="string")throw new s(`Invalid token specified: missing part #${o+1}`);let r;try{r=W(e)}catch(i){throw new s(`Invalid token specified: invalid base64 for part #${o+1} (${i.message})`)}try{return JSON.parse(r)}catch(i){throw new s(`Invalid token specified: invalid json for part #${o+1} (${i.message})`)}}var N=(()=>{let t=class t{constructor(e){this.auth=e,this.injector=T(U),this.user$=j(this.auth)}signIn(e,r){return d(this.injector,()=>y(this.auth,e,r))}signUp(e,r){return d(this.injector,()=>$(this.auth,e,r))}signInWithGoogle(){let e=new v;return C(this.auth,e)}logout(){return d(this.injector,()=>D(this.auth))}getUidObservable(){return this.user$.pipe(a(e=>e?e.uid:null))}getUidPromise(){return h(this,null,function*(){let e=yield this.auth.currentUser;return e?e.uid:null})}get CurrentUserId(){return this.auth.currentUser?this.auth.currentUser.uid:null}getCurrentUser(){return this.auth.currentUser}isLoggedIn(){return this.user$.pipe(a(e=>!!e))}getRemainingTimeObservable(){return this.getExpTimestampObservable().pipe(p(r=>r?f(1e3).pipe(b(0),a(()=>{let i=Math.floor(Date.now()/1e3),c=r-i;return Math.max(0,c)})):u(0)),m(),w({bufferSize:1,refCount:!0}))}getExpTimestampObservable(){return this.user$.pipe(p(e=>e?l(e.getIdToken(!1)).pipe(a(r=>g(r).exp)):u(-1)))}getCurrentIdToken(){return this.user$.pipe(p(e=>e?l(e.getIdToken(!1)).pipe(a(r=>g(r))):u(null)))}getExpirationDate(){return h(this,null,function*(){let e=this.getCurrentIdToken().subscribe(r=>{let i=r?.exp;if(i){let c=new Date(i*1e3),E=new Date,O=c.getTime()-E.getTime();console.log(c),console.log(O/1e3)}});return null})}};t.\u0275fac=function(r){return new(r||t)(k(x))},t.\u0275prov=I({token:t,factory:t.\u0275fac,providedIn:"root"});let n=t;return n})();export{N as a};
