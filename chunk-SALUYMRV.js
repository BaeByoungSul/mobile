import{a as D,b as g,d as h,e as v,f,g as s,h as l,i as c,k as U,l as N,m as I}from"./chunk-5KAPHWDA.js";import{bc as C,c as m,h as $,j as y,l as a,p as n,s as j}from"./chunk-3W4BXDLC.js";import{a as w,b as p,f as i}from"./chunk-D7YYRZS5.js";var x=(()=>{let o=class o{constructor(e,t,r){this.firestore=e,this.authService$=t,this.injector=r,this.notesCollection=s(this.firestore,"users")}addNote(e){return i(this,null,function*(){try{let t=this.authService$.getCurrentUser();if(!t)throw new Error("User not authenticated. Cannot add note.");yield n(this.injector,()=>i(this,null,function*(){let r=s(this.firestore,`users/${t.uid}/notes`),d=p(w({},e),{createdAt:D()});yield f(r,d)}))}catch(t){throw console.error("\u274C Error adding note: ",t),t}})}updateNote(e,t){return i(this,null,function*(){try{let r=this.authService$.getCurrentUser();if(!r)throw new Error("User not authenticated. Cannot update note.");yield n(this.injector,()=>i(this,null,function*(){let d=c(this.firestore,`users/${r.uid}/notes/${e}`);yield I(d,t)}))}catch(r){throw console.error("\u274C Error updating note: ",r),r}})}deleteNote(e){return i(this,null,function*(){try{let t=this.authService$.getCurrentUser();if(!t)throw new Error("User not authenticated. Cannot delete note.");yield n(this.injector,()=>i(this,null,function*(){let r=c(this.firestore,`users/${t.uid}/notes/${e}`);yield l(r)}))}catch(t){throw console.error("\u274C Error deleting note: ",t),t}})}getNotes(){return this.authService$.user$.pipe($(e=>e?n(this.injector,()=>{let t=s(this.firestore,`users/${e.uid}/notes`),r=N(t,U("createdAt","desc"));return h(r,{idField:"id"})}):m([])))}getNote(e){return n(this.injector,()=>{let t=c(this.firestore,`users/${this.authService$.CurrentUserId}/notes/${e}`);return v(t,{idField:"id"})})}getNotes_bak(){return h(this.notesCollection,{idField:"id"})}addNote_bak(e,t){let r=s(this.firestore,"notes");return f(r,{uid:t,content:e,timestamp:Date.now()})}deleteNote_bak(e){let t=c(this.firestore,`notes/${e}`);return l(t)}};o.\u0275fac=function(t){return new(t||o)(a(g),a(C),a(j))},o.\u0275prov=y({token:o,factory:o.\u0275fac,providedIn:"root"});let u=o;return u})();export{x as a};
